<div class="two-column-container">
  <div content-section [ngClass]="{ 'expanded': hideSidebar }">

    <div class="profile-header-container" (click)="openEditPopup()">
      <app-entity-header
        *ngIf="user"
        [label]="'Profile'"
        [title]="user.firstName + ' ' + user.lastName"
        [subtitle]="user.userRole"
        [imageUrl]="user.imageUrl ?? 'defaultPic.jpg'">
      </app-entity-header>
    </div>

    <app-tabs [tabs]="tabs" (tabChange)="onTabChange($event)"></app-tabs>

    <div class="profile-cards-holder">
      <ng-container *ngIf="activeTab === 'My Reports'">
        <div style="height: 26px"></div>
        <app-search-bar></app-search-bar>
        <div class="stats-cards">
          <app-stat-card
            *ngFor="let card of statCards"
            [label]="card.label"
            [value]="card.value"
            [period]="card.period"
            [risk]="card.risk">
          </app-stat-card>
        </div>
      </ng-container>

      <ng-container *ngIf="activeTab === 'View History'">
        <div style="height: 26px"></div>
        <app-search-bar></app-search-bar>
        <app-history-table></app-history-table>
      </ng-container>

      <ng-container *ngIf="activeTab === 'Recommendations'">
        <p>This is the Recommendations section.</p>
      </ng-container>
    </div>
  </div>

  <div sidebar-section [ngClass]="{ 'collapsed': hideSidebar }">
    <app-daily-report-form
      *ngIf="user"
      [user]="user"
      (formSubmit)="onDailyReportSubmit($event)">
    </app-daily-report-form>
  </div>
</div>

<app-edit-profile
  *ngIf="showEditPopup && user as nonNullUser"
  [user]="nonNullUser"
  (close)="closeEditPopup()">
</app-edit-profile>
